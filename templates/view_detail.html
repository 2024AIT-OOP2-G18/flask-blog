<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <title>æŠ•ç¨¿è©³ç´°</title>
</head>
<body>
    <h1>{{ blog.title }}</h1>
    <p>{{ blog.contents }}</p>
    <p>ã„ã„ã­æ•°: {{ blog.likes }}</p>
    <button id="like-button">ã„ã„ã­ğŸ‘</button>
    <p>ä½œæˆæ—¥æ™‚: {{ blog.created_at }}</p>

    <h2>ã‚³ãƒ¡ãƒ³ãƒˆä¸€è¦§</h2>
    {% if comments %}
        <p>
            {% for comment in comments %}
                {{comment.comment}}
            {% endfor %}
        <p>
    {% else %}
        <p>ã‚³ãƒ¡ãƒ³ãƒˆã¯ã¾ã ã‚ã‚Šã¾ã›ã‚“ã€‚</p>
    {% endif %}

    <textarea name="" id="comment-area"></textarea>
    <button id="comment-button">ã‚³ãƒ¡ãƒ³ãƒˆã™ã‚‹</button>


    <script>
        // ã„ã„ã­ãƒœã‚¿ãƒ³ãŒã‚¯ãƒªãƒƒã‚¯ã•ã‚ŒãŸæ™‚ã®å‡¦ç† 
        $('#like-button').on('click', function() {
            $.post('/like', {
                'blog_id': {{blog.id}}
            }).done(function(data, textStatus, jqXHR) {
                // jqXHR.statusã‚’ä½¿ã£ã¦ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚³ãƒ¼ãƒ‰ã‚’ç¢ºèª
                if (jqXHR.status === 200) {
                    location.reload();
                } else {
                    alert('ã„ã„ã­ã«å¤±æ•—ã—ã¾ã—ãŸ');
                }
            });
        });

        // ã‚³ãƒ¡ãƒ³ãƒˆæŠ•ç¨¿å‡¦ç†
        $('#comment-button').on('click', function() {
            $.post('/comment', {
                'blog_id': {{blog.id}},
                'comment': $('#comment-area').val()
            }).done(function(data, textStatus, jqXHR) {
                // jqXHR.statusã‚’ä½¿ã£ã¦ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚³ãƒ¼ãƒ‰ã‚’ç¢ºèª
                if (jqXHR.status === 200) {
                    alert('ã‚³ãƒ¡ãƒ³ãƒˆã—ã¾ã—ãŸ');
                    location.reload();
                } else {
                    alert('ã‚³ãƒ¡ãƒ³ãƒˆã«å¤±æ•—ã—ã¾ã—ãŸ');
                }
            });
        });
    </script>
</body>
</html>